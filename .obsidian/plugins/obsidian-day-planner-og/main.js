/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var jt=Object.create;var ee=Object.defineProperty;var Vt=Object.getOwnPropertyDescriptor;var zt=Object.getOwnPropertyNames;var Ht=Object.getPrototypeOf,Ut=Object.prototype.hasOwnProperty;var Xt=(n,e,t)=>e in n?ee(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var qt=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Jt=(n,e)=>{for(var t in e)ee(n,t,{get:e[t],enumerable:!0})},st=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of zt(e))!Ut.call(n,i)&&i!==t&&ee(n,i,{get:()=>e[i],enumerable:!(s=Vt(e,i))||s.enumerable});return n};var it=(n,e,t)=>(t=n!=null?jt(Ht(n)):{},st(e||!n||!n.__esModule?ee(t,"default",{value:n,enumerable:!0}):t,n)),Kt=n=>st(ee({},"__esModule",{value:!0}),n);var C=(n,e,t)=>Xt(n,typeof e!="symbol"?e+"":e,t);var Ve=qt(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});var b=require("obsidian"),We="YYYY-MM-DD",Oe="gggg-[W]ww",ct="YYYY-MM",ut="YYYY-[Q]Q",pt="YYYY";function se(n){let e=window.app.plugins.getPlugin("periodic-notes");return e&&e.settings?.[n]?.enabled}function ie(){try{let{internalPlugins:n,plugins:e}=window.app;if(se("daily")){let{format:r,folder:o,template:l}=e.getPlugin("periodic-notes")?.settings?.daily||{};return{format:r||We,folder:o?.trim()||"",template:l?.trim()||""}}let{folder:t,format:s,template:i}=n.getPluginById("daily-notes")?.instance?.options||{};return{format:s||We,folder:t?.trim()||"",template:i?.trim()||""}}catch(n){console.info("No custom daily note settings found!",n)}}function re(){try{let n=window.app.plugins,e=n.getPlugin("calendar")?.options,t=n.getPlugin("periodic-notes")?.settings?.weekly;if(se("weekly"))return{format:t.format||Oe,folder:t.folder?.trim()||"",template:t.template?.trim()||""};let s=e||{};return{format:s.weeklyNoteFormat||Oe,folder:s.weeklyNoteFolder?.trim()||"",template:s.weeklyNoteTemplate?.trim()||""}}catch(n){console.info("No custom weekly note settings found!",n)}}function oe(){let n=window.app.plugins;try{let e=se("monthly")&&n.getPlugin("periodic-notes")?.settings?.monthly||{};return{format:e.format||ct,folder:e.folder?.trim()||"",template:e.template?.trim()||""}}catch(e){console.info("No custom monthly note settings found!",e)}}function ae(){let n=window.app.plugins;try{let e=se("quarterly")&&n.getPlugin("periodic-notes")?.settings?.quarterly||{};return{format:e.format||ut,folder:e.folder?.trim()||"",template:e.template?.trim()||""}}catch(e){console.info("No custom quarterly note settings found!",e)}}function le(){let n=window.app.plugins;try{let e=se("yearly")&&n.getPlugin("periodic-notes")?.settings?.yearly||{};return{format:e.format||pt,folder:e.folder?.trim()||"",template:e.template?.trim()||""}}catch(e){console.info("No custom yearly note settings found!",e)}}function dt(...n){let e=[];for(let s=0,i=n.length;s<i;s++)e=e.concat(n[s].split("/"));let t=[];for(let s=0,i=e.length;s<i;s++){let r=e[s];!r||r==="."||t.push(r)}return e[0]===""&&t.unshift(""),t.join("/")}function en(n){let e=n.substring(n.lastIndexOf("/")+1);return e.lastIndexOf(".")!=-1&&(e=e.substring(0,e.lastIndexOf("."))),e}async function tn(n){let e=n.replace(/\\/g,"/").split("/");if(e.pop(),e.length){let t=dt(...e);window.app.vault.getAbstractFileByPath(t)||await window.app.vault.createFolder(t)}}async function ce(n,e){e.endsWith(".md")||(e+=".md");let t=b.normalizePath(dt(n,e));return await tn(t),t}async function U(n){let{metadataCache:e,vault:t}=window.app,s=b.normalizePath(n);if(s==="/")return Promise.resolve(["",null]);try{let i=e.getFirstLinkpathDest(s,""),r=await t.cachedRead(i),o=window.app.foldManager.load(i);return[r,o]}catch(i){return console.error(`Failed to read the daily note template '${s}'`,i),new b.Notice("Failed to read the daily note template"),["",null]}}function $(n,e="day"){let t=n.clone().startOf(e).format();return`${e}-${t}`}function ft(n){return n.replace(/\[[^\]]*\]/g,"")}function nn(n,e){if(e==="week"){let t=ft(n);return/w{1,2}/i.test(t)&&(/M{1,4}/.test(t)||/D{1,4}/.test(t))}return!1}function X(n,e){return mt(n.basename,e)}function sn(n,e){return mt(en(n),e)}function mt(n,e){let s={day:ie,week:re,month:oe,quarter:ae,year:le}[e]().format.split("/").pop(),i=window.moment(n,s,!0);if(!i.isValid())return null;if(nn(s,e)&&e==="week"){let r=ft(s);if(/w{1,2}/i.test(r))return window.moment(n,s.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return i}var Ye=class extends Error{};async function ht(n){let e=window.app,{vault:t}=e,s=window.moment,{template:i,format:r,folder:o}=ie(),[l,c]=await U(i),a=n.format(r),f=await ce(o,a);try{let h=await t.create(f,l.replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,s().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(_,y,x,A,u,m)=>{let N=s(),v=n.clone().set({hour:N.get("hour"),minute:N.get("minute"),second:N.get("second")});return x&&v.add(parseInt(A,10),u),m?v.format(m.substring(1).trim()):v.format(r)}).replace(/{{\s*yesterday\s*}}/gi,n.clone().subtract(1,"day").format(r)).replace(/{{\s*tomorrow\s*}}/gi,n.clone().add(1,"d").format(r)));return e.foldManager.save(h,c),h}catch(h){console.error(`Failed to create file: '${f}'`,h),new b.Notice("Unable to create new file.")}}function rn(n,e){return e[$(n,"day")]??null}function on(){let{vault:n}=window.app,{folder:e}=ie(),t=n.getAbstractFileByPath(b.normalizePath(e));if(!t)throw new Ye("Failed to find daily notes folder");let s={};return b.Vault.recurseChildren(t,i=>{if(i instanceof b.TFile){let r=X(i,"day");if(r){let o=$(r,"day");s[o]=i}}}),s}var Qe=class extends Error{};function an(){let{moment:n}=window,e=n.localeData()._week.dow,t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;e;)t.push(t.shift()),e--;return t}function ln(n){return an().indexOf(n.toLowerCase())}async function gt(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=re(),[r,o]=await U(t),l=n.format(s),c=await ce(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,h,_,y,x,A)=>{let u=window.moment(),m=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return _&&m.add(parseInt(y,10),x),A?m.format(A.substring(1).trim()):m.format(s)}).replace(/{{\s*title\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(f,h,_)=>{let y=ln(h);return n.weekday(y).format(_.trim())}));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function cn(n,e){return e[$(n,"week")]??null}function un(){let n={};if(!wt())return n;let{vault:e}=window.app,{folder:t}=re(),s=e.getAbstractFileByPath(b.normalizePath(t));if(!s)throw new Qe("Failed to find weekly notes folder");return b.Vault.recurseChildren(s,i=>{if(i instanceof b.TFile){let r=X(i,"week");if(r){let o=$(r,"week");n[o]=i}}}),n}var Ge=class extends Error{};async function At(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=oe(),[r,o]=await U(t),l=n.format(s),c=await ce(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,h,_,y,x,A)=>{let u=window.moment(),m=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return _&&m.add(parseInt(y,10),x),A?m.format(A.substring(1).trim()):m.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function pn(n,e){return e[$(n,"month")]??null}function dn(){let n={};if(!_t())return n;let{vault:e}=window.app,{folder:t}=oe(),s=e.getAbstractFileByPath(b.normalizePath(t));if(!s)throw new Ge("Failed to find monthly notes folder");return b.Vault.recurseChildren(s,i=>{if(i instanceof b.TFile){let r=X(i,"month");if(r){let o=$(r,"month");n[o]=i}}}),n}var Ze=class extends Error{};async function fn(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=ae(),[r,o]=await U(t),l=n.format(s),c=await ce(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,h,_,y,x,A)=>{let u=window.moment(),m=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return _&&m.add(parseInt(y,10),x),A?m.format(A.substring(1).trim()):m.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function mn(n,e){return e[$(n,"quarter")]??null}function hn(){let n={};if(!yt())return n;let{vault:e}=window.app,{folder:t}=ae(),s=e.getAbstractFileByPath(b.normalizePath(t));if(!s)throw new Ze("Failed to find quarterly notes folder");return b.Vault.recurseChildren(s,i=>{if(i instanceof b.TFile){let r=X(i,"quarter");if(r){let o=$(r,"quarter");n[o]=i}}}),n}var je=class extends Error{};async function gn(n){let{vault:e}=window.app,{template:t,format:s,folder:i}=le(),[r,o]=await U(t),l=n.format(s),c=await ce(i,l);try{let a=await e.create(c,r.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,h,_,y,x,A)=>{let u=window.moment(),m=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return _&&m.add(parseInt(y,10),x),A?m.format(A.substring(1).trim()):m.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function An(n,e){return e[$(n,"year")]??null}function wn(){let n={};if(!bt())return n;let{vault:e}=window.app,{folder:t}=le(),s=e.getAbstractFileByPath(b.normalizePath(t));if(!s)throw new je("Failed to find yearly notes folder");return b.Vault.recurseChildren(s,i=>{if(i instanceof b.TFile){let r=X(i,"year");if(r){let o=$(r,"year");n[o]=i}}}),n}function _n(){let{app:n}=window,e=n.internalPlugins.plugins["daily-notes"];if(e&&e.enabled)return!0;let t=n.plugins.getPlugin("periodic-notes");return t&&t.settings?.daily?.enabled}function wt(){let{app:n}=window;if(n.plugins.getPlugin("calendar"))return!0;let e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.weekly?.enabled}function _t(){let{app:n}=window,e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.monthly?.enabled}function yt(){let{app:n}=window,e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.quarterly?.enabled}function bt(){let{app:n}=window,e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.yearly?.enabled}function yn(n){let e={day:ie,week:re,month:oe,quarter:ae,year:le}[n];return e()}function bn(n,e){return{day:ht,month:At,week:gt}[n](e)}p.DEFAULT_DAILY_NOTE_FORMAT=We;p.DEFAULT_MONTHLY_NOTE_FORMAT=ct;p.DEFAULT_QUARTERLY_NOTE_FORMAT=ut;p.DEFAULT_WEEKLY_NOTE_FORMAT=Oe;p.DEFAULT_YEARLY_NOTE_FORMAT=pt;p.appHasDailyNotesPluginLoaded=_n;p.appHasMonthlyNotesPluginLoaded=_t;p.appHasQuarterlyNotesPluginLoaded=yt;p.appHasWeeklyNotesPluginLoaded=wt;p.appHasYearlyNotesPluginLoaded=bt;p.createDailyNote=ht;p.createMonthlyNote=At;p.createPeriodicNote=bn;p.createQuarterlyNote=fn;p.createWeeklyNote=gt;p.createYearlyNote=gn;p.getAllDailyNotes=on;p.getAllMonthlyNotes=dn;p.getAllQuarterlyNotes=hn;p.getAllWeeklyNotes=un;p.getAllYearlyNotes=wn;p.getDailyNote=rn;p.getDailyNoteSettings=ie;p.getDateFromFile=X;p.getDateFromPath=sn;p.getDateUID=$;p.getMonthlyNote=pn;p.getMonthlyNoteSettings=oe;p.getPeriodicNoteSettings=yn;p.getQuarterlyNote=mn;p.getQuarterlyNoteSettings=ae;p.getTemplateInfo=U;p.getWeeklyNote=cn;p.getWeeklyNoteSettings=re;p.getYearlyNote=An;p.getYearlyNoteSettings=le});var Hn={};Jt(Hn,{default:()=>Se});module.exports=Kt(Hn);var Le=require("obsidian");var k=require("obsidian");var be=class{constructor(){this.customFolder="Day Planners";this.mode=0;this.mermaid=!1;this.notesToDates=[];this.completePastItems=!0;this.circularProgress=!1;this.nowAndNextInStatusBar=!1;this.showTaskNotification=!1;this.timelineZoomLevel=4;this.timelineIcon="calendar-with-checkmark";this.plannerLabel="Day Planner";this.breakLabel="BREAK";this.endLabel="END";this.markCurrent=!1;this.correctLabels=!0;this.writer=void 0;this.preserveValues="-"}},j=class{constructor(e,t){this.notePath=e,this.date=t}},W=class{exists(e){return e&&this.active(e)!==void 0}active(e){let t=new Date().toDateString();return e&&e.filter(s=>s.date===t)[0]}},S=(s=>(s[s.File=0]="File",s[s.Command=1]="Command",s[s.Daily=2]="Daily",s))(S||{});var rt="YYYYMMDD",ot=/(?<target>{{date:?(?<date>[^}]*)}})/g,at="Day Planner-{{date}}.md",xe=`## Day Planner
- [ ] `,V="timeline";var lt=["any-key","audio-file","blocks","broken-link","bullet-list","calendar-with-checkmark","checkmark","create-new","cross","cross-in-box","crossed-star","dice","document","documents","dot-network","enter","expand-vertically","filled-pin","folder","gear","go-to-file","hashtag","help","horizontal-split","image-file","info","install","languages","left-arrow","left-arrow-with-tail","lines-of-text","link","logo-crystal","magnifying-glass","microphone","microphone-filled","open-vault","pane-layout","paper-plane","pdf-file","pencil","pin","popup-open","presentation","reset","right-arrow","right-arrow-with-tail","right-triangle","search","sheets-in-box","star","star-list","switch","three-horizontal-bars","trash","two-columns","up-and-down-arrows","uppercase-lowercase-a","vault","vertical-split","vertical-three-dots"];var Q=class{replace(e){let t=ot,s=e,i=[],r;for(;r=t.exec(s);)i.push(r);if(!i||i.length===0)return e;let o=new Date,l=i.map(a=>{let f=a.groups.date===""?rt:a.groups.date;return[a.groups.target,this.getMoment(o,f)]}),c=s;return l.forEach(a=>{c=c.replace(a[0],a[1])}),c}getMoment(e,t){return window.moment,window.moment(e).format(t)}};var ve=class extends k.PluginSettingTab{constructor(t,s){super(t,s);this.momentDateRegex=new Q;this.plugin=s}display(){let{containerEl:t}=this;t.empty(),new k.Setting(t).setName("Day Planner mode").setDesc(this.modeDescriptionContent()).addDropdown(s=>s.addOption(S[0],"File mode").addOption(S[1],"Command mode").addOption(S[2],"Daily mode").setValue(S[this.plugin.settings.mode]||0 .toString()).onChange(i=>{this.plugin.settings.mode=S[i],this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Complete past planner items").setDesc("The plugin will automatically mark checkboxes for tasks and breaks in the past as complete (x)").addToggle(s=>s.setValue(this.plugin.settings.completePastItems).onChange(i=>{this.plugin.settings.completePastItems=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Mark in progress planner item").setDesc("The plugin will automatically mark the textbox for the current item as in progress (/)").addToggle(s=>s.setValue(this.plugin.settings.markCurrent).onChange(i=>{this.plugin.settings.markCurrent=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Status bar - circular progress").setDesc("Display a circular progress bar in the status bar").addToggle(s=>s.setValue(this.plugin.settings.circularProgress).onChange(i=>{this.plugin.settings.circularProgress=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Status bar - now and next").setDesc("Display now and next tasks in the status bar").addToggle(s=>s.setValue(this.plugin.settings.nowAndNextInStatusBar).onChange(i=>{this.plugin.settings.nowAndNextInStatusBar=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Task notification").setDesc("Display a notification when a new task is started").addToggle(s=>s.setValue(this.plugin.settings.showTaskNotification).onChange(i=>{this.plugin.settings.showTaskNotification=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Timeline zoom level").setDesc("The zoom level to display the timeline. The higher the number, the more vertical space each task will take up.").addSlider(s=>s.setLimits(1,5,1).setValue(this.plugin.settings.timelineZoomLevel??4).setDynamicTooltip().onChange(i=>{this.plugin.settings.timelineZoomLevel=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Timeline icon").setDesc("The icon of the timeline pane. Reopen timeline pane or restart obsidian to see the change.").addDropdown(s=>(lt.forEach(i=>s.addOption(i,i)),s.setValue(this.plugin.settings.timelineIcon??"calendar-with-checkmark").onChange(i=>{this.plugin.settings.timelineIcon=i,this.plugin.saveData(this.plugin.settings)}))),new k.Setting(t).setName("Day Planner heading").setDesc("Use this heading text to mark the beginning of the Day Planner.").addText(s=>s.setValue(this.plugin.settings.plannerLabel??"Day Planner").onChange(i=>{i=i.trim(),i.length>0&&(this.plugin.settings.plannerLabel=i,this.plugin.saveData(this.plugin.settings))})),new k.Setting(t).setName("BREAK task label").setDesc("Use this label to mark break between tasks.").addText(s=>s.setValue(this.plugin.settings.breakLabel??"BREAK").onChange(i=>{this.plugin.settings.breakLabel=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("END task label").setDesc("Use this label to mark the end of all tasks.").addText(s=>s.setValue(this.plugin.settings.endLabel??"END").onChange(i=>{this.plugin.settings.endLabel=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Consistent BREAK and END labels").setDesc("Replace BREAK and END task text in your planner with the configured label text (consistency)").addToggle(s=>s.setValue(this.plugin.settings.correctLabels).onChange(i=>{this.plugin.settings.correctLabels=i,this.plugin.saveData(this.plugin.settings)})),new k.Setting(t).setName("Preserve task values").setDesc("Preserve these values in the schedule, for example '-' for canceled, or '>' for rescheduled.").addText(s=>s.setValue(this.plugin.settings.preserveValues||"-").onChange(i=>{i.length>0&&(i=[...new Set(i)].join("").replace("x","")),this.plugin.settings.preserveValues=i}))}modeDescriptionContent(){let t=document.createDocumentFragment();return t.appendText("Choose between 3 modes to use the Day Planner plugin:"),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("strong")).appendText("File mode"),t.appendChild(document.createElement("br")),t.appendText("Plugin automatically generates day planner notes for each day within a Day Planners folder."),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("strong")).appendText("Command mode"),t.appendChild(document.createElement("br")),t.appendText("Command used to insert a Day Planner for today within the current note."),t.appendChild(document.createElement("br")),t.appendChild(document.createElement("strong")).appendText("Daily mode"),t.appendChild(document.createElement("br")),t.appendText("Plugin automatically links to the current daily note. Daily notes plugin must be enabled."),t.appendChild(document.createElement("br")),this.addDocsLink(t),t}addDocsLink(t){let s=document.createElement("a");s.href="https://github.com/ebullient/obsidian-day-planner-og/blob/main/README.md",s.text="plugin README",s.target="_blank",t.appendChild(s),t.appendChild(document.createElement("br"))}};var te=class{constructor(e,t,s,i,r,o){this.settings=e,this.statusBar=t,this.workspace=s,this.progress=i,this.plannerMD=r,this.file=o}initStatusBar(){if(this.statusBarAdded)return;let e=this.statusBar.createEl("div",{cls:"day-planner",title:"View the Day Planner",prepend:!0});this.setupCard(e),this.statusBarText=e.createEl("span",{cls:["status-bar-item-segment","day-planner-status-bar-text"]}),this.setupCircularProgressBar(e),this.setupHorizontalProgressBar(e),this.nextText=e.createEl("span",{cls:["status-bar-item-segment","day-planner-status-bar-text"]}),this.setupStatusBarEvents(e),this.statusBarAdded=!0}setupStatusBarEvents(e){e.onClickEvent(async t=>{try{let s=this.file.todayPlannerFilePath();this.workspace.openLinkText(s,"",!1)}catch(s){console.log(s)}}),e.on("mouseenter",".day-planner",()=>{this.show(this.card)}),e.on("mouseleave",".day-planner",()=>{this.hide(this.card)})}async refreshStatusBar(e){return!e.empty&&!e.invalid?(this.updateProgress(e.current,e.next),this.show(this.statusBar)):this.hide(this.statusBar),e}hide(e){e&&(e.style.display="none")}show(e){e&&(e.style.display="block")}hideProgress(){this.hide(this.statusBarProgress),this.hide(this.circle),this.hide(this.nextText)}updateProgress(e,t){if(!e||!t||e.isEnd){this.hideProgress(),this.statusBarText.innerText=this.settings.endLabel;return}let{percentageComplete:s,minsUntilNext:i}=this.progress.getProgress(e,t);this.settings.circularProgress?(this.hide(this.statusBarProgress),this.progressCircle(s,e)):(this.hide(this.circle),this.progressBar(s,e)),this.statusText(i,e,t,s)}progressBar(e,t){t.isBreak?this.statusBarCurrentProgress.addClass("green"):this.statusBarCurrentProgress.removeClass("green"),this.statusBarCurrentProgress.style.width=`${e}%`,this.show(this.statusBarProgress)}progressCircle(e,t){t.isBreak?this.circle.addClass("green"):this.circle.removeClass("green"),this.circle.setAttr("data-value",e.toFixed(0)),this.show(this.circle)}statusText(e,t,s,i){e=e==="0"?"1":e;let r=`${e} min${e==="1"?"":"s"}`;if(this.settings.nowAndNextInStatusBar)this.statusBarText.innerHTML=`<strong>Now</strong> ${t.rawTime} ${this.ellipsis(t.text,10)}`,this.nextText.innerHTML=`<strong>Next</strong> ${s.rawTime} ${this.ellipsis(s.text,10)}`,this.show(this.nextText);else{this.hide(this.nextText);let f=t.isBreak?`${this.settings.breakLabel} for ${r}`:`${r} left`;this.statusBarText.innerText=f}let o=`Current Task (${i.toFixed(0)}% complete)`,l=`${t.rawTime} ${t.text}`,c=`Next Task (in ${r})`,a=`${s.rawTime} ${s.text}`;this.cardCurrent.innerHTML=`<strong>${o}</strong><br> ${l}`,this.cardNext.innerHTML=`<strong>${c}</strong><br> ${a}`,this.taskNotification(t,l,c,a)}taskNotification(e,t,s,i){this.settings.showTaskNotification&&this.currentTime!==void 0&&this.currentTime!==e.time.toUTCString()&&new Notification(`Task started, ${t}`,{body:`${s}: ${i}`,requireInteraction:!0}),this.currentTime=e.time.toUTCString()}ellipsis(e,t){return e.length<=t?e:e.substring(0,t)+"..."}setupHorizontalProgressBar(e){this.statusBarProgress=e.createEl("div",{cls:["status-bar-item-segment","day-planner-progress-bar"]}),this.statusBarProgress.style.display="none",this.statusBarCurrentProgress=this.statusBarProgress.createEl("div",{cls:"day-planner-progress-value"})}setupCircularProgressBar(e){this.circle=e.createEl("div",{cls:["status-bar-item-segment","progress-pie day-planner"]})}setupCard(e){this.card=e.createEl("div",{cls:"day-planner-status-card"}),this.cardCurrent=this.card.createEl("span"),this.card.createEl("br"),this.card.createEl("br"),this.cardNext=this.card.createEl("span"),this.card.createEl("div",{cls:"arrow-down"})}};var z=window.moment,ne=class{getProgress(e,t){try{let i=z(new Date),r=z(e.time),o=z(t.time),l=z.duration(o.diff(r)),c=z.duration(i.diff(r)),a=z.duration(o.diff(i)),f=c.asMinutes()/l.asMinutes()*100,h=a.asMinutes().toFixed(0);return{percentageComplete:f,minsUntilNext:h}}catch(s){console.log(s)}}progressMarkdown(e,t){try{let{percentageComplete:s}=this.getProgress(e,t),i=Math.floor(20*(s/100));return new Array(i).join("->")+new Array(20-i).join("_ ")}catch(s){console.log(s)}}};var Re=require("obsidian");var L=class{constructor(e,t){this.iAmWriter=t,this.empty=e.length<1,this.invalid=!1,this.items=e,this.past=[]}addItem(e){this.items.push(e),this.empty=!1}calculate(e){try{if(this.items.sort((t,s)=>t.time.getTime()-s.time.getTime()),this.items.length===0){this.empty=!0;return}this.items.forEach((t,s)=>{let i=this.items[s+1];if(t.time<e&&(t.isEnd||i&&e<i.time)?(this.current=t,t.isEnd&&(t.isPast=!0,this.past.push(t)),this.next=t.isEnd?null:i):t.time<e&&(t.isPast=!0,this.past.push(t)),i){let r=window.moment,o=r.duration(r(i.time).diff(r(t.time))).asMinutes();t.durationMins=o}})}catch(t){console.log(t)}}isCurrent(e){return e==this.current}},Me=class{constructor(e,t,s,i,r,o,l,c,a){this.line=e,this.charIndex=t,this.status=s,this.isBreak=i,this.isEnd=r,this.time=o,this.rawTime=l,this.text=c,this.raw=a}},Ee=class{constructor(e){this.settings=e}getPlanItem(e,t,s,i,r,o,l,c,a){let f=this.getDisplayText(i,r,c);return new Me(e,t,s,i,r,o,l,f,a)}getDisplayText(e,t,s){return e&&this.settings.correctLabels?this.settings.breakLabel:t&&this.settings.correctLabels?this.settings.endLabel:s}};var H=class{constructor(e,t,s,i,r){this.workspace=e,this.settings=t,this.file=s,this.parser=i,this.progress=r,this.noteForDateQuery=new W}async insertPlanner(){let e=this.file.todayPlannerFilePath(),s=this.workspace.getActiveViewOfType(Re.MarkdownView).editor.getCursor().line;await this.file.processFile(e,i=>{let r=i.split(`
`);return[...r.slice(0,s),...xe.split(`
`),...r.slice(s)].join(`
`)})}async processDayPlanner(e){try{await this.file.prepareFile();let t=this.file.todayPlannerFilePath(),s=new L([],e),i=new Date;return await this.file.processFile(t,r=>this.parser.parseContent(r,s,i)),s}catch(t){console.log(t)}}checkIsDayPlannerEditing(){let e=this.workspace.getActiveViewOfType(Re.MarkdownView);if(e==null)return;let t=e.getState(),s=this.file.todayPlannerFilePath();s&&t.file===s&&(this.dayPlannerLastEdit=new Date().getTime())}};var Pe=require("obsidian");var Ce=it(Ve()),ue=class{constructor(e,t){this.vault=e,this.settings=t,this.momentDateRegex=new Q,this.noteForDateQuery=new W}async hasTodayNote(){if(this.settings.mode==2&&(0,Ce.appHasDailyNotesPluginLoaded)()){let e=new Date,{folder:t,format:s}=(0,Ce.getDailyNoteSettings)(),i=this.momentDateRegex.getMoment(e,s)+".md",r=(0,Pe.normalizePath)(t+"/"+i);if(await this.vault.adapter.exists(r)){let o=new j(r,e.toDateString());return this.settings.notesToDates=[o],!0}return!1}return this.settings.mode===0||this.noteForDateQuery.exists(this.settings.notesToDates)}todayPlannerFilePath(){if(this.settings.mode===1||this.settings.mode===2)return this.noteForDateQuery.active(this.settings.notesToDates)?.notePath;let e=this.todayPlannerFileName();return`${this.settings.customFolder??"Day Planners"}/${e}`}todayPlannerFileName(){return this.momentDateRegex.replace(at)}async prepareFile(){try{this.settings.mode===0&&(await this.createFolderIfNotExists(this.settings.customFolder),await this.createFileIfNotExists(this.todayPlannerFilePath()))}catch(e){console.log(e)}}async createFolderIfNotExists(e){try{let t=(0,Pe.normalizePath)(e);await this.vault.adapter.exists(t,!1)||await this.vault.createFolder(t)}catch(t){console.log(t)}}async createFileIfNotExists(e){try{let t=(0,Pe.normalizePath)(e);await this.vault.adapter.exists(t,!1)||await this.vault.create(t,xe)}catch(t){console.log(t)}}async processFile(e,t){try{return await this.vault.adapter.process(e,t)}catch(s){console.log(s)}}};var pe=class{constructor(e){this.updateSettings(e),this.PLAN_PARSER_REGEX=new RegExp("^(-?[\\s]*\\[?(?<completion>.)\\]\\s*?(?<hours>\\d{1,2}):(?<minutes>\\d{2})\\s(?<text>.*?))$","i")}updateSettings(e){this.settings=e,this.planItemFactory=new Ee(e),this.PLAN_START=`# ${this.settings.plannerLabel}`;let t=this.sanitize(e.breakLabel),s=this.sanitize(e.endLabel);this.PLAN_BREAK=new RegExp(`(?<=^|\\s)${t}(?=\\s|$)`),this.PLAN_END=new RegExp(`(?<=^|\\s)${s}(?=\\s|$)`)}sanitize(e){return e.replace(/\./g,"\\.").replace(/\*/g,"\\*").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]")}parseContent(e,t,s){let i=!1,r=e.split(`
`);return r.forEach((o,l)=>{if(o.length!=0)if(i){if(o=="---"){i=!1;return}let c=this.parseLine(l,o);c&&(t.addItem(c),i=!c.isEnd)}else o.trim().endsWith(this.PLAN_START)&&(i=!0)}),t.calculate(s),!t.empty&&t.iAmWriter&&t.items.forEach(o=>{let l=this.updateItemCompletion(o,t);r[o.line]=l}),r.join(`
`)}parseLine(e,t){try{let s=this.PLAN_PARSER_REGEX.exec(t);if(s){let i=s,r=i.groups.text,o=this.matches(r,this.PLAN_BREAK),l=this.matches(r,this.PLAN_END),c=new Date;return c.setHours(parseInt(i.groups.hours)),c.setMinutes(parseInt(i.groups.minutes)),c.setSeconds(0),this.planItemFactory.getPlanItem(e,i.index,i.groups.completion,o,l,c,`${i.groups.hours.padStart(2,"0")}:${i.groups.minutes}`,r,i[0])}}catch(s){console.log(s)}}updateItemCompletion(e,t){let s=e.status;return this.settings.completePastItems&&(this.settings.preserveValues.includes(s)||(e.isPast?s="x":this.settings.markCurrent&&t.isCurrent(e)?s="/":s=" ")),`- [${s}] ${e.rawTime} ${e.text}`}matches(e,t){return t.test(e.trim().toUpperCase())}};var Gt=require("obsidian");function F(){}function ze(n){return n()}function De(){return Object.create(null)}function B(n){n.forEach(ze)}function de(n){return typeof n=="function"}function ke(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function xt(n){return Object.keys(n).length===0}var He=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var Ie=class n{constructor(e){C(this,"_listeners","WeakMap"in He?new WeakMap:void 0);C(this,"_observer");C(this,"options");this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(e=>{for(let t of e)n.entries.set(t.target,t),this._listeners.get(t.target)?.(t)}))}};Ie.entries="WeakMap"in He?new WeakMap:void 0;var vt=!1;function Et(){vt=!0}function Pt(){vt=!1}function D(n,e){n.appendChild(e)}function Ct(n,e,t){let s=Dt(n);if(!s.getElementById(e)){let i=E("style");i.id=e,i.textContent=t,En(s,i)}}function Dt(n){if(!n)return document;let e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function En(n,e){return D(n.head||n,e),e.sheet}function T(n,e,t){n.insertBefore(e,t||null)}function I(n){n.parentNode&&n.parentNode.removeChild(n)}function kt(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function E(n){return document.createElement(n)}function fe(n){return document.createTextNode(n)}function O(){return fe(" ")}function Ue(n,e,t,s){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t,s)}function w(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function It(n){return Array.from(n.childNodes)}function Fe(n,e){e=""+e,n.data!==e&&(n.data=e)}function M(n,e,t,s){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,s?"important":"")}function Ft(n){let e={};return n.childNodes.forEach(t=>{e[t.slot||"default"]=!0}),e}var Y;function R(n){Y=n}function Xe(){if(!Y)throw new Error("Function called outside component initialization");return Y}function qe(n){Xe().$$.on_mount.push(n)}function G(n){Xe().$$.on_destroy.push(n)}var Z=[];var Nt=[],J=[],$t=[],Fn=Promise.resolve(),Ke=!1;function Bt(){Ke||(Ke=!0,Fn.then(Te))}function me(n){J.push(n)}var Je=new Set,q=0;function Te(){if(q!==0)return;let n=Y;do{try{for(;q<Z.length;){let e=Z[q];q++,R(e),Tn(e.$$)}}catch(e){throw Z.length=0,q=0,e}for(R(null),Z.length=0,q=0;Nt.length;)Nt.pop()();for(let e=0;e<J.length;e+=1){let t=J[e];Je.has(t)||(Je.add(t),t())}J.length=0}while(Z.length);for(;$t.length;)$t.pop()();Ke=!1,Je.clear(),R(n)}function Tn(n){if(n.fragment!==null){n.update(),B(n.before_update);let e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(me)}}function St(n){let e=[],t=[];J.forEach(s=>n.indexOf(s)===-1?e.push(s):t.push(s)),t.forEach(s=>s()),J=e}var Nn=new Set;function Ne(n,e){n&&n.i&&(Nn.delete(n),n.i(e))}function he(n){return n?.length!==void 0?n:Array.from(n)}var Bn=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Sn=new Set([...Bn]);function Mn(n,e,t){let{fragment:s,after_update:i}=n.$$;s&&s.m(e,t),me(()=>{let r=n.$$.on_mount.map(ze).filter(de);n.$$.on_destroy?n.$$.on_destroy.push(...r):B(r),n.$$.on_mount=[]}),i.forEach(me)}function Rn(n,e){let t=n.$$;t.fragment!==null&&(St(t.after_update),B(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Wn(n,e){n.$$.dirty[0]===-1&&(Z.push(n),Bt(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Lt(n,e,t,s,i,r,o=null,l=[-1]){let c=Y;R(n);let a=n.$$={fragment:null,ctx:[],props:r,update:F,not_equal:i,bound:De(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:De(),dirty:l,skip_bound:!1,root:e.target||c.$$.root};o&&o(a.root);let f=!1;if(a.ctx=t?t(n,e.props||{},(h,_,...y)=>{let x=y.length?y[0]:_;return a.ctx&&i(a.ctx[h],a.ctx[h]=x)&&(!a.skip_bound&&a.bound[h]&&a.bound[h](x),f&&Wn(n,h)),_}):[],a.update(),f=!0,B(a.before_update),a.fragment=s?s(a.ctx):!1,e.target){if(e.hydrate){Et();let h=It(e.target);a.fragment&&a.fragment.l(h),h.forEach(I)}else a.fragment&&a.fragment.c();e.intro&&Ne(n.$$.fragment),Mn(n,e.target,e.anchor),Pt(),Te()}R(c)}var On;typeof HTMLElement=="function"&&(On=class extends HTMLElement{constructor(e,t,s){super();C(this,"$$ctor");C(this,"$$s");C(this,"$$c");C(this,"$$cn",!1);C(this,"$$d",{});C(this,"$$r",!1);C(this,"$$p_d",{});C(this,"$$l",{});C(this,"$$l_u",new Map);this.$$ctor=e,this.$$s=t,s&&this.attachShadow({mode:"open"})}addEventListener(e,t,s){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){let i=this.$$c.$on(e,t);this.$$l_u.set(t,i)}super.addEventListener(e,t,s)}removeEventListener(e,t,s){if(super.removeEventListener(e,t,s),this.$$c){let i=this.$$l_u.get(t);i&&(i(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(r){return()=>{let o;return{c:function(){o=E("slot"),r!=="default"&&w(o,"name",r)},m:function(a,f){T(a,o,f)},d:function(a){a&&I(o)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let t={},s=Ft(this);for(let r of this.$$s)r in s&&(t[r]=[e(r)]);for(let r of this.attributes){let o=this.$$g_p(r.name);o in this.$$d||(this.$$d[o]=et(o,r.value,this.$$p_d,"toProp"))}for(let r in this.$$p_d)!(r in this.$$d)&&this[r]!==void 0&&(this.$$d[r]=this[r],delete this[r]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});let i=()=>{this.$$r=!0;for(let r in this.$$p_d)if(this.$$d[r]=this.$$c.$$.ctx[this.$$c.$$.props[r]],this.$$p_d[r].reflect){let o=et(r,this.$$d[r],this.$$p_d,"toAttribute");o==null?this.removeAttribute(this.$$p_d[r].attribute||r):this.setAttribute(this.$$p_d[r].attribute||r,o)}this.$$r=!1};this.$$c.$$.after_update.push(i),i();for(let r in this.$$l)for(let o of this.$$l[r]){let l=this.$$c.$on(r,o);this.$$l_u.set(o,l)}this.$$l={}}}attributeChangedCallback(e,t,s){this.$$r||(e=this.$$g_p(e),this.$$d[e]=et(e,s,this.$$p_d,"toProp"),this.$$c?.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}});function et(n,e,t,s){let i=t[n]?.type;if(e=i==="Boolean"&&typeof e!="boolean"?e!=null:e,!s||!t[n])return e;if(s==="toAttribute")switch(i){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e??null;default:return e}else switch(i){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var ge=class{constructor(){C(this,"$$");C(this,"$$set")}$destroy(){Rn(this,1),this.$destroy=F}$on(e,t){if(!de(t))return F;let s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{let i=s.indexOf(t);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!xt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Mt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Mt);var K=[];function Ae(n,e=F){let t,s=new Set;function i(l){if(ke(n,l)&&(n=l,t)){let c=!K.length;for(let a of s)a[1](),K.push(a,n);if(c){for(let a=0;a<K.length;a+=2)K[a][0](K[a+1]);K.length=0}}}function r(l){i(l(n))}function o(l,c=F){let a=[l,c];return s.add(a),s.size===1&&(t=e(i,r)||F),l(n),()=>{s.delete(a),s.size===0&&t&&(t(),t=null)}}return{set:i,update:r,subscribe:o}}var we=Ae(new L([],!1)),_e=Ae(0),$e=Ae(new Date),Be=Ae(4);function Yn(n){Ct(n,"svelte-1cww04s",'#day-planner-timeline-container.svelte-1cww04s.svelte-1cww04s{position:relative;--skobeloff:#006466ff;--midnight-green-eagle-green:#065a60ff;--midnight-green-eagle-green-2:#0b525bff;--midnight-green-eagle-green-3:#144552ff;--charcoal:#1b3a4bff;--prussian-blue:#212f45ff;--space-cadet:#272640ff;--dark-purple:#312244ff;--russian-violet:#3e1f47ff;--russian-violet-2:#4d194dff}.aside.svelte-1cww04s.svelte-1cww04s{position:absolute;top:-1px;left:0;width:65px;height:100%;background-repeat:repeat-y;opacity:80%}.aside-x5.svelte-1cww04s.svelte-1cww04s{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAEsCAYAAADHIkNEAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAABLAAAAAAuMW7GAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAAAsElEQVR4Ae3ZMQoAIAgFUL3/ocsO0GBLFE9wESJ8jj8jYlQrAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBbwWyNutGQuuNIkCAAAECBAgQIECAAAECBAgQIECAAAECBAgQeEbgJBLaLScq2smYEyBAgAABAgQIECBAgAABAgQIECBAgAABAgSuCpxEQqKfqyfzOQECBAgQIECAAAECBAgQIECAAAECBAgQIECgKzABwWUEBHBCyqYAAAAASUVORK5CYII=)}.aside-x4.svelte-1cww04s.svelte-1cww04s{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAADwCAYAAAAEqZSkAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAA8AAAAABUK6+SAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAA2klEQVR4Ae3bMQqEMBBA0QT2Bh7G+5d2e5G9wRZruliM6CCBsE8QQghxeOUHaynlvb/zPHUf9TXPuCYlQIAAAQIECBAgQIAAAQIECBAg8N8CLegtNwk+V863i7crB7sza7cev8y0ze/4MX2RAAECBAgQIECAAAECBAgQIECAAIEmkGmbkdyheWbaZnTxmOaZaZvRxJpnJGOfAAECBAgQIECAAAECBAgQIECAwEMCmbZ5aJjRHJm2OaZhnk189590DTPStE+AAAECBAgQIECAAAECBAgQIEBgVoEfgLcJ4JWKwMAAAAAASUVORK5CYII=)}.aside-x3.svelte-1cww04s.svelte-1cww04s{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAC0CAYAAACQYNzeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAtAAAAAD5WFEbAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAA6UlEQVRoBe3XQQrCQAwF0Bb0Hr2heB4v14MIOtmli8GmlFHhBQbimA7h7f48TdOjnf+pua16/Z91bUqAAAECBAgQIECAAAECHwQi58Wp1KsyfPpsbLsUX133zF/a0G3PYJq5p358GxSxdaWelWGzBAgQIECAAAECBAgQIDBUIHJenDNqTHiPbZcz1m1vrPmdIyE9f5/7MeE9KKohPW+Ze+E9a+gJECBAgAABAgQIECDwHYHIeXEqNSaM9zaKbZfen537tXO/uT4S0seE8c2a6UdQVEO6MJ4AtQQIECBAgAABAgQIECDwqwJv9lMMWDcoNMAAAAAASUVORK5CYII=)}.aside-x2.svelte-1cww04s.svelte-1cww04s{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAB4CAYAAAD2SgIRAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAeAAAAADVvVTBAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAAt0lEQVRoBe3YMQqAMAyF4VYUD+Ii7p7JK7t4EkVsnOoSEtql+AuC2GdIPxxCYwhhS3c7V0ytju20S6cIIIAAAggg8EcBGVh658YvZ75uXDqenSV3S14YFkswy5gKZ3keEUAAAQQQQACBnwnI7NZV2vNdqY5eRjqe9Ih59ciTMm2u+YuC50/hgjr6p0Ix6BHz6mlOEkQAAQQQQAABBBwCMrBwtvmCcbbp+G+IIoAAAggggAACCDgFHqn/Cpqy3VM1AAAAAElFTkSuQmCC)}.aside-x1.svelte-1cww04s.svelte-1cww04s{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAA8CAYAAABig0prAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAPAAAAAB4zqpIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAArElEQVRYCe2VSwqAMAxEW3WjK3eCHsT7H0bBQ/jp7LqokIQirUyhUMIkJA8y9c65Ndx6jg+tdvW0y05J4CcEsHmtcpZTqc8rR8eLsuQm0cOAeomwGA1Q4GrOrRFTSwIkkCCArWsScUvosiSpc9DxrM5KJ+xxGLY5xIHi3xbbfBuKdvpGhnESqJ8AvGJSjnFI9LDNUSKMNKLCkT7v0/LnffO35Z2T1UiABAol8ACZ6QleECm8BQAAAABJRU5ErkJggg==)}.aside__line.svelte-1cww04s.svelte-1cww04s{position:absolute;left:65px;transform:translateX(-50%);width:4px;height:100%;background:var(--text-accent)}.filled.svelte-1cww04s.svelte-1cww04s{transform-origin:top center;z-index:1;animation:scaleDown 1s ease-in-out;animation-fill-mode:forwards}.filled__line__completed.svelte-1cww04s.svelte-1cww04s{position:absolute;top:0;left:0;width:100%}.events.svelte-1cww04s.svelte-1cww04s{position:relative;padding-bottom:50px}.event_item.svelte-1cww04s.svelte-1cww04s{border-bottom:2px solid var(--background-primary);margin:0;cursor:pointer;padding:5px 10px 10px 0;width:100%;overflow:hidden}.event_item.short.svelte-1cww04s.svelte-1cww04s{padding:0}.event_item.svelte-1cww04s.svelte-1cww04s:hover{background-color:var(--interactive-accent-hover);box-shadow:0px 0px 52px -18px rgba(0, 0, 0, 0.75)}.event_item_color1.svelte-1cww04s.svelte-1cww04s{background-color:var(--skobeloff)}.event_item_color2.svelte-1cww04s.svelte-1cww04s{background-color:var(--midnight-green-eagle-green)}.event_item_color3.svelte-1cww04s.svelte-1cww04s{background-color:var(--midnight-green-eagle-green-2)}.event_item_color4.svelte-1cww04s.svelte-1cww04s{background-color:var(--midnight-green-eagle-green-3)}.event_item_color5.svelte-1cww04s.svelte-1cww04s{background-color:var(--charcoal)}.event_item_color6.svelte-1cww04s.svelte-1cww04s{background-color:var(--prussian-blue)}.event_item_color7.svelte-1cww04s.svelte-1cww04s{background-color:var(--space-cadet)}.event_item_color8.svelte-1cww04s.svelte-1cww04s{background-color:var(--dark-purple)}.event_item_color9.svelte-1cww04s.svelte-1cww04s{background-color:var(--russian-violet)}.event_item_color10.svelte-1cww04s.svelte-1cww04s{background-color:var(--russian-violet-2)}.event_item_contents.svelte-1cww04s.svelte-1cww04s{padding-left:58px}.ei_Copy.svelte-1cww04s.svelte-1cww04s,.ei_Title.svelte-1cww04s.svelte-1cww04s{color:var(--text-on-accent)}.ei_Dot.svelte-1cww04s.svelte-1cww04s,.ei_Title.svelte-1cww04s.svelte-1cww04s{display:inline-block}.ei_Dot.svelte-1cww04s.svelte-1cww04s{position:absolute;border-radius:50%;width:14px;height:14px;margin-top:5px;background-color:var(--text-accent);box-shadow:0px 0px 52px -18px rgba(0, 0, 0, 0.75);z-index:2}.dot_active.svelte-1cww04s.svelte-1cww04s{background-color:var(--text-error-hover)}.ei_Title.svelte-1cww04s.svelte-1cww04s{margin-left:26px}.ei_Copy.svelte-1cww04s.svelte-1cww04s{font-size:15px;display:inline-block;margin-left:28px}.header_title.svelte-1cww04s.svelte-1cww04s,.ei_Title.svelte-1cww04s.svelte-1cww04s,.ce_title.svelte-1cww04s.svelte-1cww04s{color:#fff}#now-line.svelte-1cww04s.svelte-1cww04s{height:4px;background-color:darkred;opacity:80%;position:absolute;z-index:3;width:100%}#now-line.svelte-1cww04s .timeline-time.svelte-1cww04s{position:relative;left:5px;top:0;background-color:darkred;color:#fff;padding:0 4px 2px 4px;border-radius:0 0 4px 4px;text-align:center}#scroll-controls.svelte-1cww04s.svelte-1cww04s{background-color:var(--background-secondary);position:sticky;bottom:0;width:100%;z-index:4;padding:8px 15px;text-align:center;height:45px}#scroll-controls.svelte-1cww04s label.svelte-1cww04s{display:block;float:left;margin:2px}#scroll-controls.svelte-1cww04s .toggle.svelte-1cww04s{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:50px;height:20px;display:block;float:left;position:relative;margin-top:5px;border-radius:50px;overflow:hidden;outline:none;border:none;cursor:pointer;background-color:var(--background-secondary-alt);transition:background-color ease 0.3s}#scroll-controls.svelte-1cww04s .toggle.svelte-1cww04s:before{content:"on    ";display:block;position:absolute;z-index:2;width:17px;height:17px;background:#fff;left:2px;top:1px;border-radius:50%;font:9px/18px Helvetica;text-transform:uppercase;font-weight:bold;text-indent:-24px;word-spacing:30px;color:#fff;text-shadow:-1px -1px rgba(0,0,0,0.15);white-space:nowrap;box-shadow:0 1px 2px rgba(0,0,0,0.2);transition:all cubic-bezier(0.3, 1.5, 0.7, 1) 0.3s}#scroll-controls.svelte-1cww04s .toggle.svelte-1cww04s:checked{background-color:var(--interactive-accent)}#scroll-controls.svelte-1cww04s .toggle.svelte-1cww04s:checked:before{left:31px}#scroll-controls.svelte-1cww04s input[type=checkbox].svelte-1cww04s:checked:after{background-color:transparent}.empty-timeline.svelte-1cww04s.svelte-1cww04s{text-align:center;vertical-align:middle;margin-top:50%}')}function Rt(n,e,t){let s=n.slice();return s[19]=e[t],s[21]=t,s}function Qn(n){let e;return{c(){e=E("div"),e.textContent="No Planner Data",w(e,"class","empty-timeline svelte-1cww04s")},m(t,s){T(t,e,s)},p:F,d(t){t&&I(e)}}}function Gn(n){let e,t,s,i,r,o,l,c,a=n[6](n[4]).format("HH:mm")+"",f,h,_,y,x,A,u,m,N=he(n[0].items),v=[];for(let g=0;g<N.length;g+=1)v[g]=Wt(Rt(n,N,g));return{c(){e=E("div"),t=E("div"),t.innerHTML=`<div class="filled__line__completed svelte-1cww04s" style="height: ${_e}px;"></div>`,i=O(),r=E("div");for(let g=0;g<v.length;g+=1)v[g].c();o=O(),l=E("div"),c=E("span"),f=fe(a),h=O(),_=E("div"),y=E("label"),y.textContent="Track time",x=O(),A=E("input"),w(t,"class","aside__line filled__line svelte-1cww04s"),w(e,"class",s="aside aside-x"+n[1]+" filled svelte-1cww04s"),M(e,"top",n[3]+"px"),w(r,"class","events svelte-1cww04s"),w(c,"class","timeline-time svelte-1cww04s"),w(l,"id","now-line"),M(l,"top",n[2]+"px"),M(l,"display",n[0].current&&!n[0].current.isEnd?"block":"none"),w(l,"class","svelte-1cww04s"),w(y,"for","auto-scroll"),w(y,"class","svelte-1cww04s"),w(A,"id","auto-scroll"),w(A,"type","checkbox"),w(A,"class","toggle svelte-1cww04s"),w(_,"id","scroll-controls"),w(_,"class","svelte-1cww04s")},m(g,P){T(g,e,P),D(e,t),T(g,i,P),T(g,r,P);for(let d=0;d<v.length;d+=1)v[d]&&v[d].m(r,null);T(g,o,P),T(g,l,P),D(l,c),D(c,f),T(g,h,P),T(g,_,P),D(_,y),D(_,x),D(_,A),A.checked=n[5],u||(m=Ue(A,"change",n[9]),u=!0)},p(g,P){if(P&2&&s!==(s="aside aside-x"+g[1]+" filled svelte-1cww04s")&&w(e,"class",s),P&8&&M(e,"top",g[3]+"px"),P&131){N=he(g[0].items);let d;for(d=0;d<N.length;d+=1){let nt=Rt(g,N,d);v[d]?v[d].p(nt,P):(v[d]=Wt(nt),v[d].c(),v[d].m(r,null))}for(;d<v.length;d+=1)v[d].d(1);v.length=N.length}P&16&&a!==(a=g[6](g[4]).format("HH:mm")+"")&&Fe(f,a),P&4&&M(l,"top",g[2]+"px"),P&1&&M(l,"display",g[0].current&&!g[0].current.isEnd?"block":"none"),P&32&&(A.checked=g[5])},d(g){g&&(I(e),I(i),I(r),I(o),I(l),I(h),I(_)),kt(v,g),u=!1,m()}}}function Wt(n){let e,t,s,i,r,o,l=n[19].rawTime+"",c,a,f,h=Ot(n[19])+"",_,y,x,A;return{c(){e=E("div"),t=E("div"),s=E("div"),r=O(),o=E("div"),c=fe(l),a=O(),f=E("div"),_=fe(h),y=O(),w(s,"class",i="ei_Dot "+(n[19]===n[0].current?"dot_active":"")+" svelte-1cww04s"),w(o,"class","ei_Title svelte-1cww04s"),w(f,"class","ei_Copy svelte-1cww04s"),w(t,"class","event_item_contents svelte-1cww04s"),w(e,"class",x="event_item event_item_color"+(n[21]%10+1)+" "+n[7](n[19])+" svelte-1cww04s"),M(e,"height",n[19].durationMins*n[1]+"px"),w(e,"data-title",A=n[19].rawTime)},m(u,m){T(u,e,m),D(e,t),D(t,s),D(t,r),D(t,o),D(o,c),D(t,a),D(t,f),D(f,_),D(e,y)},p(u,m){m&1&&i!==(i="ei_Dot "+(u[19]===u[0].current?"dot_active":"")+" svelte-1cww04s")&&w(s,"class",i),m&1&&l!==(l=u[19].rawTime+"")&&Fe(c,l),m&1&&h!==(h=Ot(u[19])+"")&&Fe(_,h),m&1&&x!==(x="event_item event_item_color"+(u[21]%10+1)+" "+u[7](u[19])+" svelte-1cww04s")&&w(e,"class",x),m&3&&M(e,"height",u[19].durationMins*u[1]+"px"),m&1&&A!==(A=u[19].rawTime)&&w(e,"data-title",A)},d(u){u&&I(e)}}}function Zn(n){let e;function t(r,o){return r[0].items.length>0?Gn:Qn}let s=t(n,-1),i=s(n);return{c(){e=E("div"),i.c(),w(e,"id","day-planner-timeline-container"),w(e,"class","svelte-1cww04s")},m(r,o){T(r,e,o),i.m(e,null)},p(r,[o]){s===(s=t(r,o))&&i?i.p(r,o):(i.d(1),i=s(r),i&&(i.c(),i.m(e,null)))},i:F,o:F,d(r){r&&I(e),i.d()}}}var jn=/\[([^\]]+)\]\(([^)]+)\)/g,Vn=/\[\[([^\]|]+)(\|([^\]]+))?\]\]/g;function Ot(n){let e=n.text??"";return e=e.replace(jn,(t,s,i)=>(console.log("markdown link",n.text),`${s}`)),e=e.replace(Vn,(t,s,i,r)=>(console.log("wiki link",n.text),`${r||s}`)),e}function zn(n,e,t){let s=window.moment,{summary:i}=e,{rootEl:r}=e,o,l,c,a,f=!0,h=we.subscribe(d=>{t(0,i=d),v()}),_=_e.subscribe(d=>{t(2,l=d)}),y=$e.subscribe(d=>{t(4,a=d),N(l-150),o||t(1,o=4)}),x=Be.subscribe(d=>{t(1,o=d)});G(h),G(_),G(y),G(x),G(u),qe(()=>{A()});function A(){r.addEventListener("scroll",m)}function u(){r.removeEventListener("scroll",m)}function m(d){t(5,f=!1)}function N(d){f&&!i.current?.isEnd&&(u(),r.scrollTo({left:0,top:d,behavior:"smooth"}),setTimeout(A,1e3))}function v(){t(3,c=i.empty?0:i.items.first().time.getMinutes()*o*-1-1)}function g(d){return classes=[],d.durationMins<75/o&&classes.push("short"),d.isPast&&classes.push("past"),d.isBreak&&classes.push("break"),classes.join(" ")}function P(){f=this.checked,t(5,f)}return n.$$set=d=>{"summary"in d&&t(0,i=d.summary),"rootEl"in d&&t(8,r=d.rootEl)},[i,o,l,c,a,f,s,g,r,P]}var tt=class extends ge{constructor(e){super(),Lt(this,e,zn,Zn,ke,{summary:0,rootEl:8},Yn)}},Yt=tt;var Qt=window.moment,ye=class extends Gt.ItemView{constructor(e,t){super(e),this.settings=t}getViewType(){return V}getDisplayText(){return"Day Planner Timeline"}getIcon(){return this.settings.timelineIcon}update(e){we.update(i=>i=e);let t=new Date;$e.update(i=>i=t);let s=e.empty?0:this.positionFromTime(t)-this.positionFromTime(e.items.first().time);_e.update(i=>i=s),Be.update(i=>i=this.settings.timelineZoomLevel)}positionFromTime(e){return Qt.duration(Qt(e).format("HH:mm")).asMinutes()*this.settings.timelineZoomLevel}async onOpen(){this.timeline=new Yt({target:this.contentEl,props:{planSummary:we,rootEl:this.containerEl.children[1]}})}};var Zt=it(Ve()),Se=class extends Le.Plugin{constructor(){super(...arguments);this.codeMirror=t=>{this.file.hasTodayNote()&&this.plannerMD.checkIsDayPlannerEditing()}}get syncPlugin(){return this.app.internalPlugins.getPluginById("sync")}async onload(){console.log("Loading Day Planner plugin v"+this.manifest.version),this.vault=this.app.vault,this.settings=Object.assign(new be,await this.loadData()),this.notesForDatesQuery=new W,this.file=new ue(this.vault,this.settings);let t=this.syncPlugin?.instance!=null;this.device=t?this.syncPlugin.instance.deviceName.length>0?this.syncPlugin.instance.deviceName:this.syncPlugin.instance.getDefaultDeviceName():"Unknown",console.debug("DPOG: Device/Writer:",this.settings.mode,this.device,this.settings.writer,this.isWriter());let s=new ne;this.parser=new pe(this.settings),this.plannerMD=new H(this.app.workspace,this.settings,this.file,this.parser,s),this.statusBar=new te(this.settings,this.addStatusBarItem(),this.app.workspace,s,new H(this.app.workspace,this.settings,this.file,this.parser,s),this.file),this.statusBar.initStatusBar(),this.registerEvent(this.app.vault.on("modify",this.codeMirror,"")),this.addCommand({id:"app:add-to-note",name:"Add a Day Planner template for today to the current note",callback:()=>this.modeGuard(async()=>await this.insertDayPlannerIntoCurrentNote(!0)),hotkeys:[]}),this.addCommand({id:"app:link-to-note",name:"Link today's Day Planner to the current note",callback:()=>this.modeGuard(async()=>await this.insertDayPlannerIntoCurrentNote(!1)),hotkeys:[]}),this.addCommand({id:"app:unlink-from-note",name:"Unlink today's Day Planner from its note",callback:()=>this.modeGuard(async()=>await this.unlinkDayPlanner()),hotkeys:[]}),this.addCommand({id:"app:show-timeline",name:"Show the Day Planner Timeline",callback:()=>this.initLeaf(),hotkeys:[]}),this.addCommand({id:"app:show-today-note",name:"Show today's Day Planner",callback:()=>this.app.workspace.openLinkText(this.file.todayPlannerFilePath(),"",!0),hotkeys:[]}),this.addCommand({id:"app:set-as-writer",name:`Set current device '${this.device}' as writer`,callback:async()=>{this.settings.writer=this.device,this.save()},hotkeys:[]}),this.registerView(V,i=>this.timelineView=new ye(i,this.settings)),this.addSettingTab(new ve(this.app,this)),this.setTicker(),window.dayPlanner={resolvePath:this.resolvePath.bind(this)},this.register(()=>delete window.dayPlanner)}async onunload(){this.interval&&(console.debug("DPOG: Clearing ticker"),window.clearInterval(this.interval))}async handleConfigFileChange(){await super.handleConfigFileChange(),this.settings=Object.assign(this.settings,await this.loadData()),this.parser.updateSettings(this.settings);let t=await this.file.hasTodayNote();console.log("DPOG: update Device/Writer:",this.settings.mode,this.device,this.settings.writer,this.isWriter(),t)}isWriter(){return this.device==="Unknown"||!this.settings.writer||this.settings.writer===this.device}setTicker(){this.interval&&(console.debug("DPOG: Clearing ticker"),window.clearInterval(this.interval),this.interval=void 0),console.log("DPOG: set Ticker with Device/Writer:",this.device,this.settings.writer,this.isWriter()),this.interval=window.setInterval(()=>this.tick(),2e3)}async tick(){try{if(await this.file.hasTodayNote()){let t=await this.plannerMD.processDayPlanner(this.isWriter());await this.statusBar.refreshStatusBar(t),this.timelineView&&this.timelineView.update(t)}else if(this.settings.mode==2&&(0,Zt.appHasDailyNotesPluginLoaded)()){let t=new L([],this.isWriter());await this.statusBar.refreshStatusBar(t),this.timelineView&&this.timelineView.update(t)}}catch(t){console.log(t)}}initLeaf(){this.app.workspace.getLeavesOfType(V).length>0||this.app.workspace.getRightLeaf(!0).setViewState({type:V})}modeGuard(t){if(this.settings.mode!==1){new Notification("Day Planner plugin in File mode",{silent:!0,body:"Switch to Command mode in settings to use this command"});return}else t()}async insertDayPlannerIntoCurrentNote(t){try{let i=this.app.workspace.getActiveViewOfType(Le.MarkdownView).getState().file,r=this.notesForDatesQuery.exists(this.settings.notesToDates),o=this.notesForDatesQuery.active(this.settings.notesToDates)?.notePath;if(this.settings.notesToDates=this.settings.notesToDates||[],r&&o!==i){new Notification("Day Planner exists",{silent:!0,body:`A Day Planner for today already exists in ${o}`});return}else r?this.settings.notesToDates||(this.settings.notesToDates=[]):this.settings.notesToDates=[new j(i,new Date().toDateString())];await this.save(),t&&this.plannerMD.insertPlanner()}catch(s){console.error(s)}}async unlinkDayPlanner(){try{let t=this.notesForDatesQuery.active(this.settings.notesToDates);if(!t){new Notification("No Day Planner found",{silent:!0,body:"No Day Planner found for today"});return}this.settings.notesToDates=this.settings.notesToDates||[],this.settings.notesToDates.remove(t),await this.save(),this.statusBar.hide(this.statusBar.statusBar),this.timelineView&&this.timelineView.update(new L([],this.isWriter())),new Notification("Day Planner reset",{silent:!0,body:`The Day Planner for today has been dissociated from ${t.notePath} and can be added to another note`})}catch(t){console.error(t)}}async save(){await this.saveData(this.settings)}resolvePath(t){let s=this.file.todayPlannerFilePath();return this.app.metadataCache.getFirstLinkpathDest(t,s).path}};
